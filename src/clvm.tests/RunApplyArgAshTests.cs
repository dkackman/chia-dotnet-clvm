namespace clvm.tests;

public class RunApplyArgAshTests
{
#pragma warning disable CS8625 // Cannot convert null literal to non-nullable reference type.
    public static IEnumerable<object[]> TestData =>
    [
        // apply-00
        [new object[] { "(a (q . 2) (q . (3 4 5)))" }, new object[] { "3", 188L }],
        // apply-01
        [new object[] { "(a (q . 5) (q . (3 4 5)))" }, new object[] { "4", 192L }],
        // apply-02
        [new object[] { "(a (q . 11) 1)", "(5 6 7 8 9)" }, new object[] { "7", 220L }],
        // apply-03
        [new object[] { "(a)" }, new object[] { null }],
        // apply-04
        [new object[] { "(a (q . +))" }, new object[] { null }],
        // apply-05
        [new object[] { "(a (q . +) (q . (1 2 3)) (q . foo))" }, new object[] { null }],
        // apply-06
        [new object[] { "(a (q . (+ 2 5)) (q . (20 30)))" }, new object[] { "50", 996L }],
        // apply-07
        [new object[] { "(a (q . q) (q . (2 3 4)))", null, null, true }, new object[] { "(2 3 4)", 184L, null, false }],
        // args-00
        [new object[] { "0", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "()", 53L, null, false }],
        // args-01
        [new object[] { "1", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "(((8 . 12) 10 . 14) (9 . 13) 11 . 15)", 53L, null, false }],
        // args-02
        [new object[] { "2", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "((8 . 12) 10 . 14)", 57L, null, false }],
        // args-03
        [new object[] { "3", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "((9 . 13) 11 . 15)", 57L, null, false }],
        // args-04
        [new object[] { "4", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "(8 . 12)", 61L, null, false }],
        // args-05
        [new object[] { "5", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "(9 . 13)", 61L, null, false }],
        // args-06
        [new object[] { "6", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "(10 . 14)", 61L, null, false }],
        // args-07
        [new object[] { "7", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "(11 . 15)", 61L, null, false }],
        // args-08
        [new object[] { "8", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "8", 65L, null, false }],
        // args-09
        [new object[] { "9", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "9", 65L, null, false }],
        // args-10
        [new object[] { "10", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "10", 65L, null, false }],
        // args-11
        [new object[] { "11", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "11", 65L, null, false }],
        // args-12
        [new object[] { "12", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "12", 65L, null, false }],
        // args-13
        [new object[] { "13", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "13", 65L, null, false }],
        // args-14
        [new object[] { "14", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "14", 65L, null, false }],
        // args-15
        [new object[] { "15", "(((8 . 12) . (10 . 14)) . ((9 . 13) . (11 . 15)))" }, new object[] { "15", 65L, null, false }],
        // ash-1
        [new object[] { "(ash (q . 7) (q . 1))" }, new object[] { "14", 662L }],
        // ash-2
        [new object[] { "(ash (q . 7) (q . 100))" }, new object[] { "0x70000000000000000000000000", 818L }],
        // ash-3
        [new object[] { "(ash (q . -7) (q . 100))" }, new object[] { "0x90000000000000000000000000", 818L }],
        // ash-4
        [new object[] { "(ash (q . 0x90000000000000000000000000) (q . -100))" }, new object[] { "-7", 698L }],
        // ash-5
        [new object[] { "(ash (q . 1))" }, new object[] { null }],
        // ash-6
        [new object[] { "(ash (q . 1) (q . 1) (q . 1))" }, new object[] { null }],
        // ash-7
        [new object[] { "(ash (q . (foo)) (q . 1))" }, new object[] { null }],
        // ash-8
        [ new object[] { "(ash (q . 500) (q . 65535))" },
            new object[] {
                "0x00fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                107171L
            }
        ],
        // ash-9
        [new object[] { "(ash (q . 500) (q . -65535))" }, new object[] { "()", 652L }],
        // ash-a
        [new object[] { "(ash (q . 500) (q . 65536))" }, new object[] { null }],
        // ash-b
        [new object[] { "(ash (q . 500) (q . -65536))" }, new object[] { null }],
        // ash-c
        [new object[] { "(ash (q . 0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007) (q . 0x0000000000000000000000000000000000000000000000000000000000000001))" }, new object[] { null }],

        // apply-01
        [new object[] { "(a)" }, new object[] { null }],

        // apply-02
        [new object[] { "(a (q . 1))" }, new object[] { null }],

        // apply-03
        [new object[] { "(a (q . 1) (q . 1))", null, null, true }, new object[] { "1" }],

        // apply-04
        [new object[] { "(a (q . 1) (q . 1) (q . 1))" }, new object[] { null }],

        // apply-05
        [new object[] { "(a (q . 1) (q . 1) (q . 1) (q . 1))" }, new object[] { null }],

        // apply-06
        [new object[] { "(a () () ())" }, new object[] { null }],

        // apply-07
        [new object[] { "(a (q . (1 2)) (q . (1 2)) (q . (1 2)))" }, new object[] { null }],

        // apply-08
        [new object[] { "(a (q . 0xffff) (q . 0xffff) (q . 0xffff))" }, new object[] { null }],

        // apply-09
        [new object[] { "(a (q . 128) (q . 128) (q . 128))" }, new object[] { null }],

        // apply-10
        [new object[] { "(a (q . -1) (q . -1) (q . -1))" }, new object[] { null }],

        // ash-01
        [new object[] { "(ash)" }, new object[] { null }],

        // ash-02
        [new object[] { "(ash (q . 1))" }, new object[] { null }],

        // ash-03
        [new object[] { "(ash (q . 1) (q . 1))" }, new object[] { "2" }],

        // ash-04
        [new object[] { "(ash () ())" }, new object[] { "()" }],

        // ash-05
        [new object[] { "(ash (q . (1 2)) (q . (1 2)))" }, new object[] { null }],

        // ash-06
        [new object[] { "(ash (q . 0xffff) (q . 0xffff))" }, new object[] { "-1" }],

        // ash-07
        [new object[] { "(ash (q . 128) (q . 128))" }, new object[] { "0x008000000000000000000000000000000000" }],

        // ash-08
        [new object[] { "(ash (q . -1) (q . -1))" }, new object[] { "-1" }],

    ];

    [Theory]
    [MemberData(nameof(TestData))]
    public void TestRun(object[] input, object[] output)
    {
        RunTestHelper.Run(input, output);
    }
}